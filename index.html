<!DOCTYPE html>
<html lang="en">
	
	<head>
		
		<meta charset="utf-8">
		<meta http-equiv="content-type" content="text/html">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="Description" content="An interactive map to aid cycle planning in Scotland">
		
		<!-- Favicon -->
		<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
		<link rel="icon" href="favicon.ico" type="image/x-icon">
		
		<!-- Social media -->
		<meta property="og:title" content="NPT Scotland">
		<meta property="og:description" content="An interactive map to aid cycle planning in Scotland">
		<meta property="og:image" content="/images/thumbnail.jpg">
		<meta property="twitter:image" content="/images/thumbnail.jpg">
		<meta property="og:url" content="https://www.npt.scot">
		<meta name="twitter:card" content="summary_large_image">
		<meta property="og:site_name" content="NPT Scotland">
		<meta name="twitter:image:alt" content="NPT Scotland thumbnail">
		<title>NPT Scotland</title>
		
		<!-- PWA support -->
		<link rel="manifest" href="manifest.webmanifest">
		<link rel="apple-touch-icon" href="/images/icons/192.png">
		<meta name="apple-mobile-web-app-status-bar" content="#0b38e6">
		<meta name="theme-color" content="#0b38e6">
		<script src="/app.js" defer></script>
		
		<!-- Map dependencies -->
		<script src="/js/lib/pmtiles/index-2.11.0.js"></script> <!-- v2.7.1 -->
		<script src="/js/lib/geocoder/maplibre-gl-geocoder.min.js"></script>
		<link rel="stylesheet" href="js/lib/geocoder/maplibre-gl-geocoder-small.css" type="text/css"/>
		<script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
		<link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
		
		<!-- Sliders -->
		<link href="js/lib/noUiSlider_15_7_0/nouislider.min.css" rel="stylesheet">
		<script src="js/lib/noUiSlider_15_7_0/nouislider.min.js"></script>
		
		<!-- Font Awesome -->
		<link href="/assets/fontawesome/css/fontawesome.css" rel="stylesheet">
		<link href="/assets/fontawesome/css/solid.min.css" rel="stylesheet">
		
		<!-- Markdown conversion -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
		
		<!-- Tooltips -->
		<script src="https://unpkg.com/@popperjs/core@2"></script>
		<script src="https://unpkg.com/tippy.js@6"></script>
		
		<!-- Charts -->
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1" defer></script>
		
		<!-- Google tag (gtag.js) -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-QZMHV92YXJ"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag () {dataLayer.push (arguments);}
			gtag('js', new Date ());
			gtag('config', 'G-QZMHV92YXJ');
		</script>
		
		<!-- Styles -->
		<link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="css/modal.css" defer>
		
		<!-- NPT application -->
		<script src="src/settings.js"></script>
		<script src="src/datasets.js"></script>
		<script src="src/nptui.js"></script>
		<script>
			document.addEventListener ('DOMContentLoaded', function () {
			  nptUi.initialise (settings, datasets);
			});
		</script>
		
	</head>
	
	<body>
		
		<!-- Menu -->
		<div class="nav-wrapper">
			<div class="topnav" id="myTopnav">
				<div class="main-title">
					<a href="/">NPT Scotland</a>
				</div>
				<a href="/about">About</a>
				<a href="/data">Data</a>
				<a href="/manual">Manual</a>
				<a class="smaller" href="/privacy">Privacy &amp; accessibility</a>
				<a href="#" id="expandtopnav" class="icon" aria-label="Expand Menu"><i class="fa fa-bars"></i></a>
			</div>
			<div class="logo">
				<img src="/images/npt_logo.png" alt="NPT Logo" height="40">
			</div>
		</div>
		
		<!-- Welcome Splash -->
		<div id="welcome" class="welcome">
			<span class="modal-close">&times;</span>
			<div>
				<h3>Network Planning Tool for Scotland</h3>
				<p>The Network Planning Tool for Scotland (NPT Scotland, hosted at <a href="https://www.npt.scot">www.npt.scot</a>) is a web application for strategic cycle network planning.</p>
				<p>Note the results of the Commute layer are based  on the 2011 Census travel to work data and results for other trip purposes are based on pre-pandemic data. Users should be aware that the results are model-based estimates and that patterns have changed since the pandemic. Future versions of the tool will include more recent Census and other datasets when they become available.</p>
				<p>The results are publicly available. The main intended audience is local authorities undertaking cycle network planning to support  evidence-based and transparent investment, scheme location and design decisions.</p>
				<p>Last updated: <span id="updatedate"></span>. You may need to <a href="https://www.minitool.com/news/f5-vs-ctrl-f5.html">clear your browser cache</a> to see the latest updates.</p>
				<p>To report issues or provide feedback, please use the <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=qO3qvR3IzkWGPlIypTW3ywVZfmO0bwdAhK0UztpneQtUM1pCRlJQQjY1V0M3MUhBV0g0VTJRS1ZQVi4u" target="_blank">feedback form</a>.</p>
				<p>Date of OSM Data on which network results are based: 
				<p id="osmupdatedate"></p>
				<p id="logos">
					<a href="https://environment.leeds.ac.uk/transport" target="_blank"><img src="/images/logos/leeds.png" alt="University of Leeds" /></a>
					<a href="https://www.sustrans.org.uk/about-us/our-work-in-scotland" target="_blank"><img src="/images/logos/sustrans.png" alt="Sustrans" /></a>
					<a href="https://www.transport.gov.scot/" target="_blank"><img src="/images/logos/transportscotland.svg" alt="Transport Scotland" /></a>
					<a href="https://www.cyclestreets.org/" target="_blank"><img src="/images/logos/cyclestreets.svg" alt="CycleStreets" /></a>
					
				</p>
			</div>
		</div>
		
		<!-- Cookies Warning  -->
		<div id="cookiewarning" class="cookiewarning">
			<p>We use cookies to measure how you use our website so we can understand how you interact with it, which helps us to make improvements. <a href="/privacy">Find out more.</a></p>
			<p>
				<button class="button button1" value="1"><strong>OK</strong></button>
				<button class="button button2" value=""><strong>No</strong></button>
			</p>
		</div>
		
		<!-- Main Content -->
		<div class="content">
			<div id="map"></div>
		</div>
		
		<!-- Basemap control box -->
		<div id="basemapcontrol">
			<h3>Basemap</h3>
			<p>
			<form id="basemapform">
				<!-- Values will be populated -->
			</form>
			</p>
			<p><label class="switch"><input type="checkbox" id="placenamescheckbox" checked="checked" /><span class="slider round"></span></label> Place names</p>
			<p title="Makes the map look smoother and clearer (not suitable for lower-powered devices)"><label class="switch"><input type="checkbox" id="antialiascheckbox" /><span class="slider round"></span></label> Anti-alias</p>
		</div>
		
		<!-- Show Layer Selection Panel  Button-->
		<div id="showrightbox" class="showrightbox">
			<button class="float_button" aria-label="Show layers"><i class="fa fa-bars"></i></button>
		</div>
		
		<!-- Layer Selection Panel -->
		<div id="rightbox" class="rightbox">
			<button class="close-button" aria-label="Hide layers"><i class="fas fa-times"></i></button>
			<b>Layer Controls</b>
			<button class="accordion" id="autoopen">Route Network</button>
			<div class="panel">
				<p>
					<label><input type="checkbox" id="rnetcheckboxproxy" class="rnetproxy" checked>Show Layer</label>
					<!-- These two checkboxes actually control the layers, but are set by the show/simplified checkboxes -->
					<input type="checkbox" class="updatelayer rnethiddenproxy" data-layer="rnet" />
					<input type="checkbox" class="updatelayer rnethiddenproxy" data-layer="rnet-simplified" />
				</p>
				<p>
					<select id="rnet_purpose_input" name="rnet_purpose_input" class="updatelayer" aria-label="Route network trip purpose">
						<option value="all" selected>All</option>
						<option value="commute" >Commute</option>
						<option value="primary" >Primary School</option>
						<option value="secondary" >Secondary School</option>
						<option value="utility" >Other Everyday</option>
					</select>
					Trip purpose <button aria-label="Help purpose" class="helpbutton" title="Full details of trip purpose" data-help="purpose"><i class="fa fa-question-circle" aria-hidden="true"></i></button>
				</p>
				<p>
					<select id="rnet_scenario_input" name="rnet_scenario_input" class="updatelayer" aria-label="Route network scenario">
						<option value="bicycle">Baseline (2011)</option>
						<option value="bicycle_go_dutch" selected>Go Dutch</option>
						<option value="bicycle_ebike">Ebike</option>
					</select>
					Scenario <button aria-label="Help scenario" class="helpbutton" data-help="scenario" title="Full details of scenarios"><i class="fa fa-question-circle" aria-hidden="true"></i></button>
				</p>
				<p>
					<select id="rnet_type_input" name="rnet_type_input" class="updatelayer" aria-label="Route network type">
						<option value="fastest" selected>Fast/Direct</option>
						<option value="quietest">Quiet/Indirect</option>
					</select>
					Network type <button aria-label="Help type" class="helpbutton" data-help="type" title="Full details of type of network choice by cyclists"><i class="fa fa-question-circle" aria-hidden="true"></i></button>
				</p>
				<p>
					<select id="rnet_colour_input" name="rnet_colour_input" class="updatelayer" aria-label="Route network colour">
						<option value="none">None</option>
						<option value="flow" selected>Number of cyclists</option>
						<option value="quietness">Cycle friendliness</option>
						<option value="gradient">Gradient</option>
					</select>
					Line colour <button aria-label="Help colour" class="helpbutton" data-help="colour" title="Full details of colouring of route lines"><i class="fa fa-question-circle" aria-hidden="true"></i></button>
				</p>
				<div id="linecolourlegend" class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #ffffff"></span>&nbsp</div>
					</div>
				</div>
				<p><label class="switch"><input type="checkbox" id="rnet-simplifiedcheckboxproxy" class="rnetproxy" aria-label="Simplify route network"><span class="slider round"></span></label> Simplified <button aria-label="Help simplified route network" class="helpbutton" data-help="simplified_rnet" title="Full details of streamlining the route network"><i class="fa fa-question-circle" aria-hidden="true"></i></button></p>
			</div>
			<button class="accordion">Route Network Filters</button>
			<div class="panel">
				<p><b>Filters</b><button aria-label="Help scenario" class="helpbutton" data-help="filters" title="Full details of filtering parts of the route network"><i class="fa fa-question-circle" aria-hidden="true"></i></button></p>
				<p>Number of cyclists</p>
				<div id="rnet_slider-cycle-ui" class="slider-styled"></div>
				<datalist id="rnet_slider-cycle-ui-values" data-density="3">
					<option value="1"     data-position="min"></option>
					<!-- #!# Should there be a zero value possibility? -->
					<option value="10"    data-position="12.5%"></option>
					<option value="50"    data-position="25%"></option>
					<option value="100"   data-position="37.5%"></option>
					<option value="250"   data-position="50%"></option>
					<option value="500"   data-position="65%"></option>
					<option value="1000"  data-position="80%" data-increments="1000"></option>
					<option value="20000" data-position="max"></option>
					<!-- TODO: Check max value -->
				</datalist>
				<input type="hidden" id="rnet_slider-cycle" class="updatelayer" />
				<p>&nbsp</p>
				<p>Gradient (%)</p>
				<div id="rnet_slider-gradient-ui" class="slider-styled"></div>
				<datalist id="rnet_slider-gradient-ui-values" data-density="10">
					<option value="0"  data-position="min" data-increments="1"></option>
					<option value="1"  data-position="10%" data-increments="1"></option>
					<option value="3"  data-position="30%" data-increments="1"></option>
					<option value="5"  data-position="50%" data-increments="1"></option>
					<option value="7"  data-position="70%" data-increments="1"></option>
					<option value="9"  data-position="90%" data-increments="91"></option>
					<option value="100" data-position="max" data-label="10+"></option>
				</datalist>
				<input type="hidden" id="rnet_slider-gradient" class="updatelayer" />
				<p>&nbsp</p>
				<p>Cycle friendliness (%)</p>
				<div id="rnet_slider-quietness-ui" class="slider-styled"></div>
				<datalist id="rnet_slider-quietness-ui-values" data-density="10">
					<option value="0"   data-position="min" data-label="Hostile" data-increments="10"></option>
					<option value="100" data-position="max" data-label="Quiet"></option>
				</datalist>
				<input type="hidden" id="rnet_slider-quietness" class="updatelayer" />
				<p>&nbsp</p>
			</div>
			<button class="accordion">Data Zones</button>
			<div class="panel">
				<p><label><input type="checkbox" class="updatelayer" data-layer="data_zones" value="false">Show Layer</label></p>
				<p>
					<select id="data_zones_selector" name="data_zones_selector" class="updatelayer" aria-label="Data zone layer">
						<option value="pcycle">% commuter cycling (baseline)</option>
						<option value="pcycle_go_dutch" selected>% commuter cycling (Go Dutch)</option>
						<option value="population_density">Population density (per hectare)</option>
						<option value="SIMD2020v2_Decile">Index of Multiple Deprivation (2020)</option>
						<option value="drive_petrol">Drive time to petrol station</option>
						<option value="drive_GP">Drive time to GP</option>
						<option value="drive_post">Drive time to post office</option>
						<option value="drive_retail">Drive time to retail centre</option>
						<option value="drive_primary">Drive time to primary school</option>
						<option value="drive_secondary">Drive time to secondary school</option>
						<option value="PT_GP">Public transport time to GP</option>
						<option value="PT_post">Public transport time to post office</option>
						<option value="PT_retail">Public transport time to retail centre</option>
						<option value="broadband">% without superfast broadband</option>
					</select>
					<button aria-label="Help purpose" class="helpbutton" data-help="data_zones"><i class="fa fa-question-circle" aria-hidden="true"></i></button>
				</p>
				<div id="dzlegend" class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #ffffff"></span>&nbsp</div>
					</div>
				</div>
				<p><label class="switch"><input type="checkbox" id="data_zones_checkbox_dasymetric" class="updatelayer" checked><span class="slider round"></span></label> Dasymetric</p>
			</div>
			<button class="accordion">Other Layers</button>
			<div class="panel">
				<p><label><input type="checkbox" class="updatelayer" data-layer="schools" value="false">Schools</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #313695"></span>Primary</div>
						<div class="lb"><span style="background-color: #a50026"></span>Secondary</div>
						<div class="lb"><span style="background-color: #43f22c"></span>Other</div>
					</div>
				</div>
				<p><label><input type="checkbox" class="updatelayer" data-layer="wards" value="false">Wards</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #206b07"></span></div>
					</div>
				</div>
				<p><label><input type="checkbox" class="updatelayer" data-layer="holyrood" value="false">Scottish Parliament Constituencies</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #537bfc"></span></div>
					</div>
				</div>
				<p><label><input type="checkbox" class="updatelayer" data-layer="scot_regions" value="false">Scottish Parliament Regions</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #bab106"></span></div>
					</div>
				</div>
				<p><label><input type="checkbox" class="updatelayer" data-layer="la" value="false">Local Authorities</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #6b0707"></span></div>
					</div>
				</div>
				<p><label><input type="checkbox" class="updatelayer" data-layer="cohesivenetwork" value="false">Cohesive network</label></p>
				<div class="legend">
					<div class="l_r">
						<div class="lb"><span style="background-color: #1230b4"></span>1</div>
						<div class="lb"><span style="background-color: #894cf7"></span>2</div>
						<div class="lb"><span style="background-color: #f07984"></span>3</div>
						<div class="lb"><span style="background-color: #fff551"></span>3</div>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Help box -->
		<div id="help_modal" class="modal">
			<span class="modal-close">&times;</span>
			<div id="helpcontent">
				<p><em>Help content loading&hellip;</em></p>
			</div>
		</div>
		
		<!-- Template for chart modals, including a sub-template for the chart boxes, plus overlay -->
		<template id="chart-modal">
			<div class="modal">
				<div class="modal-content">
					<div class="modal-header">
						<span class="modal-close">&times;</span>
						<h2 class="modal-title">Summary</h2>
					</div>
					<div class="modal-body">
						<template class="chart-template">
							<div class="wrapper">
								<div class="chart-text">
									<h4 class="chart-title"></h4>
									<p class="chart-description"></p>
								</div>
								<div class="chart-container" >
									<canvas></canvas>
								</div>
							</div>
						</template>
					</div>
					<div class="modal-footer"></div>
				</div>
			</div>
		</template>
		<div id="overlay"></div>
		
		<!-- Template for map popup -->
		<template id="rnet-popup">
			<div class="mappopup">
			<p>Cyclists: {_ncycle}</p>
			<p>Gradient: {Gradient}%</p>
			<p>Cycle-friendliness: {Quietness}%</p>
			<p><a class="externallink" target="_blank" href="{_streetViewUrl}">Google Street View <i class="fa fa-external-link" aria-hidden="true"></i></a> <a class="externallink" target="_blank" href="{_osmUrl}">OpenStreetMap <i class="fa fa-external-link" aria-hidden="true"></i></a></p>
			<button class="accordion">All network details</button>
			<div class="panel" id="popuppanel">
				<h4>Fast/Direct network</h4>
				<table>
					<tr><th></th><th>Baseline</th><th>Go Dutch</th><th>Ebikes</th></tr>
					<tr><th>All</td><td>{all_fastest_bicycle}</td><td>{all_fastest_bicycle_go_dutch}</td><td>{all_fastest_bicycle_ebike}</td></tr>
					<tr><th>Commute</td><td>{commute_fastest_bicycle}</td><td>{commute_fastest_bicycle_go_dutch}</td><td>{commute_fastest_bicycle_ebike}</td></tr>
					<tr><th>Primary</td><td>{primary_fastest_bicycle}</td><td>{primary_fastest_bicycle_go_dutch}</td><td>{primary_fastest_bicycle_ebike}</td></tr>
					<tr><th>Secondary</td><td>{secondary_fastest_bicycle}</td><td>{secondary_fastest_bicycle_go_dutch}</td><td>{secondary_fastest_bicycle_ebike}</td></tr>
					<tr><th>Utility</td><td>{utility_fastest_bicycle}</td><td>{utility_fastest_bicycle_go_dutch}</td><td>{utility_fastest_bicycle_ebike}</td></tr>
				</table>
				<h4>Quiet/Indirect network</h4>
				<table>
					<tr><th></th><th>Baseline</th><th>Go Dutch</th><th>Ebikes</th></tr>
					<tr><th>All</td><td>{all_quietest_bicycle}</td><td>{all_quietest_bicycle_go_dutch}</td><td>{all_quietest_bicycle_ebike}</td></tr>
					<tr><th>Commute</td><td>{commute_quietest_bicycle}</td><td>{commute_quietest_bicycle_go_dutch}</td><td>{commute_quietest_bicycle_ebike}</td></tr>
					<tr><th>Primary</td><td>{primary_quietest_bicycle}</td><td>{primary_quietest_bicycle_go_dutch}</td><td>{primary_quietest_bicycle_ebike}</td></tr>
					<tr><th>Secondary</td><td>{secondary_quietest_bicycle}</td><td>{secondary_quietest_bicycle_go_dutch}</td><td>{secondary_quietest_bicycle_ebike}</td></tr>
					<tr><th>Utility</td><td>{utility_quietest_bicycle}</td><td>{utility_quietest_bicycle_go_dutch}</td><td>{utility_quietest_bicycle_ebike}</td></tr>
				</table>
			</div>
		</template>
		
	</body>
	
</html>